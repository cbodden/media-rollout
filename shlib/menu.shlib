function _menu()
{
    printf "%s\n" \
        "This script is for deploying, configuring, or deleting either an" \
        "entire media stack or just bits and pieces of it." \
        "" \
        "The following prompts will ask you for options so that your setup " \
        "can be tailored to your liking" ""

    _pause

    printf "%s\n" \
        "" "Let's start by selecting an action:"

    declare -a _SELECT=( "install" "configure" "delete" "exit" )

    _CNT=0
    for ITER in "${_SELECT[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose an action by number (only one): " _SELECT_READ
        if [[ ! -z ${_SELECT_READ} ]]
        then
            if ((_SELECT_READ >= 0 && _SELECT_READ <= ${_CNT}))
            then
                _SELECT_ACTION="${_SELECT[${_SELECT_READ}]}"
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done

    case ${_SELECT_ACTION} in
        'install')
            _menuTV
            _menuMVS
            _menuSBT
            _menuMUSIC
            _menuDLOAD
            _menuSRCH
            _menuBOOKS
            _menuMSERV
            _menuTTL
            _menuRUN
            exit 0
            ;;
        'configure')
            _menuCONF
            exit 0
            ;;
        'delete')
            printf "%s\n" "Being added...."
            exit 0
            ;;
        'exit')
            exit 0
            ;;
        * )
            ;;
    esac
}

function _menuCONF()
{
    declare -a _CONF=( "sabnzbdplus" "nzbhydra2" "lazylibrarian" "lidarr" "sonarr" "radarr" )

    for ITER in "${_CONF}"
    do
        _${ITER}_configure
    done

    _finish_configure
    exit 0
}

function _menuTV()
{
    printf "%s\n" \
        "" "Let's start by selecting a tv show service:"

    ##declare -a _TV=( "none" "sonarr" "sickbeard" "sickrage" )
    declare -a _TV=( "none" "sonarr"  )

    _CNT=0
    for ITER in "${_TV[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a TV service by number (only one): " _TV_READ
        if [[ ! -z ${_TV_READ} ]]
        then
            if ((_TV_READ >= 0 && _TV_READ <= ${_CNT}))
            then
                if [[ "${_TV_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_TV[${_TV_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuMVS()
{
    printf "%s\n" \
        "" "Now let's add a movie service:"

    ##declare -a _MVS=( "none" "radarr" "couchpotato" )
    declare -a _MVS=( "none" "radarr" )

    _CNT=0
    for ITER in "${_MVS[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a movie service by number (only one): " _MVS_READ
        if [[ ! -z ${_MVS_READ} ]]
        then
            if ((_MVS_READ >= 0 && _MVS_READ <= ${_CNT}))
            then
                if [[ "${_MVS_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_MVS[${_MVS_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuSBT()
{
    if [ "${_MVS_READ}" -lt 1 ] && [ "${_TV_READ}" -lt 1 ]
    then
        return
    fi

    printf "%s\n" \
        "" "Now let's add subtitle provider:"

    declare -a _SBT=( "none" "bazarr" )

    _CNT=0
    for ITER in "${_SBT[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a subtitle service by number (only one): " _SBT_READ
        if [[ ! -z ${_SBT_READ} ]]
        then
            if ((_SBT_READ >= 0 && _SBT_READ <= ${_CNT}))
            then
                if [[ "${_SBT_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_SBT[${_SBT_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuMUSIC()
{
    printf "%s\n" \
        "" "Now let's add a music service:"

    ##declare -a _MUSIC=( "none" "lidarr" "headphones" )
    declare -a _MUSIC=( "none" "lidarr" )

    _CNT=0
    for ITER in "${_MUSIC[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a music service by number (only one): " _MUSIC_READ
        if [[ ! -z ${_MUSIC_READ} ]]
        then
            if ((_MUSIC_READ >= 0 && _MUSIC_READ <= ${_CNT}))
            then
                if [[ "${_MUSIC_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_MUSIC[${_MUSIC_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuDLOAD()
{
    printf "%s\n" \
        "" "Now let's add a downloader:"

    declare -a _DLOAD=( "none" "sabnzbdplus" )

    _CNT=0
    for ITER in "${_DLOAD[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a downloader by number (only one): " _DLOAD_READ
        if [[ ! -z ${_DLOAD_READ} ]]
        then
            if ((_DLOAD_READ >= 0 && _DLOAD_READ <= ${_CNT}))
            then
                if [[ "${_DLOAD_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_DLOAD[${_DLOAD_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuSRCH()
{
    printf "%s\n" \
        "" "Now let's add search services:"

    declare -a _SRCH=( "none" "nzbhydra2" )

    _CNT=0
    for ITER in "${_SRCH[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a search service by number (only one): " _SRCH_READ
        if [[ ! -z ${_SRCH_READ} ]]
        then
            if ((_SRCH_READ >= 0 && _SRCH_READ <= ${_CNT}))
            then
                if [[ "${_SRCH_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_SRCH[${_SRCH_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuBOOKS()
{
    printf "%s\n" \
        "" "Now let's add a book service:"

    declare -a _BOOKS=( "none" "lazylibrarian" )

    _CNT=0
    for ITER in "${_BOOKS[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a book service by number (only one): " _BOOKS_READ
        if [[ ! -z ${_BOOKS_READ} ]]
        then
            if ((_BOOKS_READ >= 0 && _BOOKS_READ <= ${_CNT}))
            then
                if [[ "${_BOOKS_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_BOOKS[${_BOOKS_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuMSERV()
{
    printf "%s\n" \
        "" "Now let's add a media server:"

    declare -a _MSERV=( "none" "plexmediaserver" )

    _CNT=0
    for ITER in "${_MSERV[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a media service by number (only one): " _MSERV_READ
        if [[ ! -z ${_MSERV_READ} ]]
        then
            if ((_MSERV_READ >= 0 && _MSERV_READ <= ${_CNT}))
            then
                if [[ "${_MSERV_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_MSERV[${_MSERV_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuTTL()
{
    if [ "${_MSERV_READ}" -lt 1 ]
    then
        return
    fi

    printf "%s\n" \
        "" "Now let's add metrics for Plex:"

    declare -a _TTL=( "none" "tautulli" )

    _CNT=0
    for ITER in "${_TTL[@]}"
    do
        echo [${_CNT}] $(echo ${ITER})
        _CNT=$((_CNT+1))
    done

    _CNT=$((_CNT-1))
    while :
    do
        read -p "Choose a metrics provider by number (only one): " _TTL_READ
        if [[ ! -z ${_TTL_READ} ]]
        then
            if ((_TTL_READ >= 0 && _TTL_READ <= ${_CNT}))
            then
                if [[ "${_TTL_READ}" -ge 1 ]]
                then
                    _menuINSTALL+=( "${_TTL[${_TTL_READ}]}" )
                fi
                break
            else
                printf "%s\n" \
                    "Not a menu option. Try again."
            fi
        else
            printf "%s\n" \
                "Not a menu option. Try again."
        fi
    done
}

function _menuRUN()
{
    _pause

    printf "%s\n" \
        "" "These are your service selections:"

    for ITER in "${_menuINSTALL[@]}"
    do
        echo ${ITER}
    done

    while :
    do
        read -p "Do you want to install them (Yes or No): " _M_INSTALL
        case ${_M_INSTALL} in
            [yY][eE][sS]|[yY])
                _storage
                _apt

                for ITER in "${_menuINSTALL[@]}"
                do
                    _${ITER}_install
                done

                _finish
                _clean
                exit 0
                ;;
            [nN][oO]|[nN])
                exit 1
                ;;
            * )
                printf "%s\n" "Please answer Yes or No."
                ;;
        esac
    done
}
