function _lidarr()
{
    cd /opt/

    _LR_ADDY="https://github.com/lidarr/Lidarr/releases"

    _LR_RLS_PATH="$(curl -s ${_LR_ADDY} \
        | grep "linux.tar.gz" \
        | head -n 1 \
        | cut -d\" -f2 )"

    _LR_DLD_PATH="$(echo ${_LR_RLS_PATH} \
        | cut -d'/' -f6-7 )"

    wget ${_LR_ADDY}/download/${_LR_DLD_PATH}

    tar -xzvf ${_LR_DLD_PATH##*/}
    chown -R lidarr:lidarr /opt/Lidarr/

    cat <<EOF >/etc/systemd/system/lidarr.service
    [Unit]
    Description=Lidarr Daemon
    After=syslog.target network.target

    [Service]
    User=lidarr
    Group=lidarr
    Type=simple
    ExecStart=/usr/bin/mono /opt/Lidarr/Lidarr.exe -nobrowser
    TimeoutStopSec=20
    KillMode=process
    Restart=on-failure

    [Install]
    WantedBy=multi-user.target
EOF

    chown -R lidarr:downloads /${_PATH}/music
    systemctl daemon-reload
    systemctl enable lidarr.service
}

function _lidarr_configure()
{
    systemctl start lidarr.service
    sleep 5
    systemctl stop lidarr.service

    local _SAB_API=$(cat ${_SAB_HOME}/sabnzbd.ini \
        | awk '/^api_key/ {print $3}')

    local _NH_API=$(yq read ${_NH_HOME}/nzbhydra.yml main.apiKey)

    rm -rf ${_LR_HOME}/*

    cat ${PROGDIR}/config_files/lidarr_BASE-EDIT.sql \
        | sed "/\bSABnzbd\b/s|\bRM_SH\b|${_IP}|g" \
        | sed "/\bSABnzbd\b/s/\bRM_SP\b/8080/g" \
        | sed "/\bSABnzbd\b/s/\bRM_SA\b/${_SAB_API}/g" \
        | sed "/\bNZBHydra2\b/s|\bRM_NH\b|${_IP}|g" \
        | sed "/\bNZBHydra2\b/s/\bRM_NP\b/5076/g" \
        | sed "/\bNZBHydra2\b/s/\bRM_NA\b/${_NH_API}/g" \
        >> ${_LR_HOME}/lidarr.sql

    echo .exit | sqlite3 -init ${_LR_HOME}/lidarr.sql ${_LR_HOME}/lidarr.db
    chown -R lidarr:lidarr ${_LR_HOME}
    systemctl start lidarr
}
